# ุฏููู ุฅุนุฏุงุฏ ูุชุดุบูู Schools API

## ุงููููุงุช ุงูุชู ุชู ุฅูุดุงุคูุง:

### 1. Migration
- `database/migrations/2024_10_23_000001_add_api_fields_to_schools_table.php`

### 2. Model
- `app/Models/School.php` (ุชู ุชุญุฏูุซู)

### 3. Controller
- `app/Http/Controllers/Api/SchoolController.php`

### 4. Routes
- `routes/api.php` (ุชู ุชุญุฏูุซู)

### 5. Seeder
- `database/seeders/SchoolsSeeder.php`

---

## ุฎุทูุงุช ุงูุชุดุบูู:

### ุงูุฎุทูุฉ 1: ุชุดุบูู Migration
```bash
php artisan migrate
```

### ุงูุฎุทูุฉ 2: ุชุดุบูู Seeder (ุจูุงูุงุช ุชุฌุฑูุจูุฉ)
```bash
php artisan db:seed --class=SchoolsSeeder
```

### ุงูุฎุทูุฉ 3: ุชุดุบูู ุงูุณูุฑูุฑ
```bash
php artisan serve
```

ุงูุณูุฑูุฑ ุณูุนูู ุนูู: `http://127.0.0.1:8000`

---

## API Endpoints ุงููุชุงุญุฉ:

### 1. Get All Schools (ูุน Pagination ู Filters)
```
GET http://127.0.0.1:8000/api/schools
```

**Query Parameters:**
- `page` - ุฑูู ุงูุตูุญุฉ (default: 1)
- `limit` - ุนุฏุฏ ุงููุชุงุฆุฌ (default: 10)
- `region` - ุงูููุทูุฉ (ูุซุงู: ูุทุงุน ุบุฒุฉ)
- `city` - ุงููุฏููุฉ (ูุซุงู: ุบุฒุฉ)
- `directorate` - ุงููุฏูุฑูุฉ
- `type` - ููุน ุงููุฏุฑุณุฉ
- `level` - ุงููุฑุญูุฉ ุงูุชุนููููุฉ
- `minRating` - ุฃูู ุชูููู
- `sortBy` - ุงูุชุฑุชูุจ ุญุณุจ (default: created_at)
- `order` - asc ุฃู desc (default: desc)

**ูุซุงู:**
```
GET http://127.0.0.1:8000/api/schools?region=ูุทุงุน ุบุฒุฉ&limit=5
```

### 2. Get Single School
```
GET http://127.0.0.1:8000/api/schools/{id}
```

**ูุซุงู:**
```
GET http://127.0.0.1:8000/api/schools/1
```

### 3. Get Best Schools
```
GET http://127.0.0.1:8000/api/schools/best?limit=10
```

### 4. Get Recently Added Schools
```
GET http://127.0.0.1:8000/api/schools/recent?limit=6
```

### 5. Search Schools
```
GET http://127.0.0.1:8000/api/schools/search?q=ุงููุฌุงุญ&region=ูุทุงุน ุบุฒุฉ
```

**Query Parameters:**
- `q` - ูุต ุงูุจุญุซ
- `region` - ุงูููุทูุฉ
- `type` - ููุน ุงููุฏุฑุณุฉ
- `level` - ุงููุฑุญูุฉ
- `minRating` - ุฃูู ุชูููู

### 6. Get Schools by Region
```
GET http://127.0.0.1:8000/api/schools/by-region?region=ูุทุงุน ุบุฒุฉ
```

### 7. Get Regions List
```
GET http://127.0.0.1:8000/api/schools/regions
```

### 8. Get Statistics
```
GET http://127.0.0.1:8000/api/statistics/general
```

---

## ุงุฎุชุจุงุฑ ุงูู API:

### ุงุณุชุฎุฏุงู Postman:

1. ุงูุชุญ Postman
2. ุฃูุดุฆ Request ุฌุฏูุฏ
3. ุงุฎุชุฑ GET
4. ุฃุฏุฎู URL: `http://127.0.0.1:8000/api/schools`
5. ุงุถุบุท Send

### ุงุณุชุฎุฏุงู cURL:

```bash
# Get all schools
curl http://127.0.0.1:8000/api/schools

# Get best schools
curl http://127.0.0.1:8000/api/schools/best?limit=5

# Search
curl "http://127.0.0.1:8000/api/schools/search?q=ุงููุฌุงุญ"

# Get statistics
curl http://127.0.0.1:8000/api/statistics/general
```

### ุงุณุชุฎุฏุงู PowerShell:

```powershell
# Get all schools
Invoke-RestMethod -Uri "http://127.0.0.1:8000/api/schools" -Method Get

# Get best schools
Invoke-RestMethod -Uri "http://127.0.0.1:8000/api/schools/best?limit=5" -Method Get

# Get statistics
Invoke-RestMethod -Uri "http://127.0.0.1:8000/api/statistics/general" -Method Get
```

---

## Response Format:

ุฌููุน ุงูุงุณุชุฌุงุจุงุช ุจุงูุตูุบุฉ ุงูุชุงููุฉ:

### Success Response:
```json
{
    "success": true,
    "data": {
        "schools": [...],
        "total": 100,
        "current_page": 1,
        "last_page": 10
    },
    "message": "ุชู ุฌูุจ ุงููุฏุงุฑุณ ุจูุฌุงุญ"
}
```

### Error Response:
```json
{
    "success": false,
    "message": "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฌูุจ ุงููุฏุงุฑุณ",
    "error": "Error details..."
}
```

---

## CORS Configuration:

ุฅุฐุง ูุงุฌูุช ูุดููุฉ CORSุ ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช `config/cors.php`:

```php
'paths' => ['api/*'],
'allowed_origins' => ['http://localhost:3000'],
'allowed_methods' => ['*'],
'allowed_headers' => ['*'],
```

---

## ุงูุฎุทูุงุช ุงููุงุฏูุฉ:

1. โ ุชุดุบูู Migration
2. โ ุชุดุบูู Seeder
3. โ ุชุดุบูู ุงูุณูุฑูุฑ
4. โ ุงุฎุชุจุงุฑ ุงูู APIs
5. ๐ ุฑุจุท ุงููุฑููุช ุฅูุฏ ูุน ุงูุจุงู ุฅูุฏ
6. ๐ ุฅุถุงูุฉ APIs ููุชููููุงุช
7. ๐ ุฅุถุงูุฉ APIs ููุฅุญุตุงุฆูุงุช ุงููุชูุฏูุฉ

---

## ููุงุญุธุงุช ูููุฉ:

1. **Primary Key**: ุงููุฏุงุฑุณ ุชุณุชุฎุฏู `school_id` ูู primary key
2. **Soft Deletes**: ุบูุฑ ููุนู ุญุงููุงู (ูููู ุฅุถุงูุชู ูุงุญูุงู)
3. **Authentication**: ุงูู APIs ุงูุนุงูุฉ ูุง ุชุญุชุงุฌ authentication
4. **Validation**: ูููู ุฅุถุงูุฉ Form Requests ููู validation ูุงุญูุงู
5. **Caching**: ูููู ุฅุถุงูุฉ caching ูุชุญุณูู ุงูุฃุฏุงุก

---

## Troubleshooting:

### ุฎุทุฃ: "Class 'Database\Seeders\School' not found"
```bash
composer dump-autoload
```

### ุฎุทุฃ: "SQLSTATE[42S02]: Base table or view not found"
```bash
php artisan migrate:fresh
php artisan db:seed --class=SchoolsSeeder
```

### ุฎุทุฃ: "Target class [ApiSchoolController] does not exist"
ุชุฃูุฏ ูู namespace ูู Controller:
```php
namespace App\Http\Controllers\Api;
```
